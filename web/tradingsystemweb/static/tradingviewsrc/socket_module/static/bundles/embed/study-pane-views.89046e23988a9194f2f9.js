(window.webpackJsonp=window.webpackJsonp||[]).push([["study-pane-views"],{"0HiO":function(t,e,i){"use strict";i.r(e),i.d(e,"TrendChannelPaneView",(function(){return d}));var r=i("Eyy1"),n=i("aO4+"),o=i("hBTJ"),s=i("VdBB"),a=i("Zy3/"),l=i("8Uy/"),c=i("BCbF");class d{constructor(t,e,i){this._data=[],this._invalidated=!0,this._provider=t,this._model=e,this._data=[],this._hitTestResult=void 0!==i?new s.HitTestResult(s.HitTestResult.CUSTOM,i):new s.HitTestResult(s.HitTestResult.REGULAR)}update(){this._invalidated=!0}renderer(){this._invalidated&&(this._updateViewInternal(),this._invalidated=!1);const t=new a.CompositeRenderer;for(const e of this._data){const i=new c.PolygonRenderer(this._hitTestResult);i.setData(e),t.append(i)}return t}_updateViewInternal(){this._data=[];const t=this._provider.priceScale(),e=this._model.timeScale();if(!t||t.isEmpty()||e.isEmpty())return;const i=this._provider.graphics().trendchannels();if(0===i.size)return;const o=this._model.timeScale().visibleBarsStrictRange();if(null===o)return;const s=this._provider.firstValue();if(null===s)return;const a=o.firstBar(),c=o.lastBar();i.forEach((i,o)=>{const d=this._provider.properties().graphics.trendchannels[o];i.forEach(i=>{const o=i.startIndex,u=i.endIndex;if(Math.max(o,u)<a&&!i.extendRight||Math.min(o,u)>c&&!i.extendLeft)return;const p=t.priceToCoordinate(Object(r.ensureDefined)(i.startHighPrice),s),f=t.priceToCoordinate(Object(r.ensureDefined)(i.startLowPrice),s),_=t.priceToCoordinate(Object(r.ensureDefined)(i.endHighPrice),s),g=_-(p-f),x=e.indexToCoordinate(o),v=e.indexToCoordinate(u),[w,b]=h(new n.Point(x,p),new n.Point(v,_),e.width(),t.height(),i.extendLeft,i.extendRight),[m,y]=h(new n.Point(x,f),new n.Point(v,g),e.width(),t.height(),i.extendLeft,i.extendRight);this._data.push({points:[w,m,y,b],color:d.color.value(),backcolor:d.color.value(),linewidth:void 0!==d.borderWidth?d.borderWidth.value():0,linestyle:l.LINESTYLE_SOLID,filled:!0,fillBackground:!0,transparency:i.transparency?Math.min(i.transparency+d.transparency.value(),100):d.transparency.value(),mouseTouchable:!0})})})}}function h(t,e,i,r,s,a){if(Object(n.equalPoints)(t,e))return[t,e];const l=new n.Point(0,0),c=new n.Point(i,r);if(s){const r=t.subtract(e),s=Object(o.intersectRayAndBox)(t,t.add(r),Object(n.box)(l,c));s?t=s:e=new n.Point(i,e.y)}if(a){const r=e.subtract(t),s=Object(o.intersectRayAndBox)(e,e.add(r),Object(n.box)(l,c));e=s||new n.Point(i,e.y)}return[t,e]}},"1sos":function(t,e,i){"use strict";i.r(e),i.d(e,"HorizLinePaneView",(function(){return a}));var r=i("Eyy1"),n=i("VdBB"),o=i("Zy3/"),s=i("l4sv");class a{constructor(t,e,i){this._data=[],this._invalidated=!0,this._provider=t,this._model=e,this._hitTestResult=void 0!==i?new n.HitTestResult(n.HitTestResult.CUSTOM,i):new n.HitTestResult(n.HitTestResult.REGULAR)}update(){this._invalidated=!0}renderer(){this._invalidated&&(this._updateViewInternal(),this._invalidated=!1);const t=new o.CompositeRenderer;for(const e of this._data){const i=new s.HorizontalLineRenderer;i.setData(e),i.setHitTest(this._hitTestResult),t.append(i)}
return t}_updateViewInternal(){this._data=[];const t=this._provider.priceScale(),e=this._model.timeScale();if(!t||t.isEmpty()||e.isEmpty())return;const i=this._provider.graphics().horizlines();if(0===i.size)return;const n=this._model.timeScale().visibleBarsStrictRange();if(null===n)return;const o=this._provider.firstValue();if(null===o)return;const s=n.firstBar(),a=n.lastBar();i.forEach((i,n)=>{const l=this._provider.properties().graphics.horizlines[n];l.visible.value()&&i.forEach(i=>{const n=i.startIndex,c=i.endIndex;!i.extendRight&&Math.max(n,c)<s||!i.extendLeft&&Math.min(n,c)>a||this._data.push({y:t.priceToCoordinate(Object(r.ensureDefined)(i.level),o),left:i.extendLeft?void 0:e.indexToCoordinate(n),right:i.extendRight?void 0:e.indexToCoordinate(c),color:l.color.value(),linewidth:l.width.value(),linestyle:l.style.value()})})})}}},"292E":function(t,e,i){"use strict";i.r(e);var r=i("Eyy1"),n=i("aO4+"),o=i("972a"),s=i("nInm"),a=i("Zy3/"),l=i("f6yo"),c=i("VdBB"),d=i("ikwP"),h=i("Ialn");class u{constructor(t,e){this._data=t,this._textCache=e}draw(t,e){if(!this._data)return;const i=p(this._data.direction);let r=this._data.point.x;"left"===this._data.halign?r-=this._data.size:"right"===this._data.halign&&(r+=this._data.size);const n=this._data.point.y;t.font=this._fontStyle();const o=t.measureText(this._data.text).width;this._textCache.textWidth=o;const s=this._data.fontSize;t.textAlign=Object(h.isRtl)()?"right":"left";const a=Object(d.calcTextHorizontalShift)(t,o),l=.65*s,c=1*s;Object(d.drawScaled)(t,e.pixelRatio,()=>{t.translate(r,n),t.beginPath(),t.moveTo(0,0),t.lineTo(l,c*i),t.lineTo(.5*o+l,c*i),t.lineTo(.5*o+l,(c+1.75*s)*i),t.lineTo(.5*-o-l,(c+1.75*s)*i),t.lineTo(.5*-o-l,c*i),t.lineTo(-l,c*i),t.lineTo(0,0),t.strokeStyle=this._data.borderColor,t.stroke(),t.fillStyle=this._data.color,t.fill(),t.fillStyle=this._data.fontColor,t.fillText(this._data.text,.5*-o+a,i<0?i*c-.5*s:c+1.25*s)})}hitTest(t){const e=this._textCache.textWidth||0,i=this._data.fontSize,r=p(this._data.direction),o=.65*i,s=1*i;let a=this._data.point.x;"left"===this._data.halign?a-=this._data.size:"right"===this._data.halign&&(a+=this._data.size);const d=this._data.point.y,h=a-.5*e-o,u=a+.5*e+o;let f=d+s*r,_=d+(s+1.75*i)*r;if(_<f){const t=f;f=_,_=t}if(Object(l.pointInBox)(t,Object(n.box)(new n.Point(h,f),new n.Point(u,_))))return new c.HitTestResult(c.HitTestResult.REGULAR);const g=[new n.Point(this._data.point.x,this._data.point.y),new n.Point(this._data.point.x+.65*i,this._data.point.y+i*r),new n.Point(this._data.point.x-.65*i,this._data.point.y+i*r)],x=(t.x-g[0].x)*(g[1].y-g[0].y)-(t.y-g[0].y)*(g[1].x-g[0].x);return((t.x-g[1].x)*(g[2].y-g[1].y)-(t.y-g[1].y)*(g[2].x-g[1].x))*x>0&&((t.x-g[2].x)*(g[0].y-g[2].y)-(t.y-g[2].y)*(g[0].x-g[2].x))*x>0?new c.HitTestResult(c.HitTestResult.REGULAR):null}_fontStyle(){return(this._data.bold?"bold ":"")+(this._data.italic?"italic ":"")+`${this._data.fontSize}px ${this._data.font}`}}function p(t){if("up"===t)return 1;if("down"===t)return-1;throw new Error(t+" is not supported by TriangleTextMarkRenderer")}class f{
constructor(t,e){this._data=t,this._textCache=e}draw(t,e){const i=this._data.point.x,r=this._data.point.y;t.font=this._fontStyle();const n=t.measureText(this._data.text).width;this._textCache.textWidth=n,Object(d.drawScaled)(t,e.pixelRatio,()=>{switch(t.translate(i,r),t.beginPath(),t.moveTo(0,0),t.textAlign=this._data.halign,this._data.valign){case"middle":t.textBaseline="middle";break;case"top":t.textBaseline="bottom";break;case"bottom":t.textBaseline="hanging"}t.fillStyle=this._data.fontColor,t.fillText(this._data.text,0,0)})}hitTest(t){let e=this._data.point.x,i=this._data.point.y;const r=this._textCache.textWidth||0,o=this._data.fontSize;switch(this._data.halign){case"right":e-=r;break;case"center":e-=r/2}switch(this._data.valign){case"middle":i-=o/2;break;case"bottom":i-=o}const s=new n.Point(e,i),a=new n.Point(e+r,i+o);return Object(l.pointInBox)(t,Object(n.box)(s,a))?new c.HitTestResult(c.HitTestResult.REGULAR):null}_fontStyle(){return(this._data.bold?"bold ":"")+(this._data.italic?"italic ":"")+`${this._data.fontSize}px ${this._data.font}`}}var _=i("tSCe"),g=i.n(_),x=i("Tmoa");i.d(e,"TextMarkPaneView",(function(){return v}));class v extends g.a{constructor(t,e,i){super(),this._data=[],this._textCache=[],this._invalidated=!0,this._provider=t,this._model=e,this._data=[],this._textCache=[]}update(){this._invalidated=!0}renderer(){this._invalidated&&(this._updateViewInternal(),this._invalidated=!1);const t=new a.CompositeRenderer;for(let e=0;e<this._data.length;e++){const i=this._data[e],r=this._textCache[e];switch(i.shape){case"triangle":t.append(new u(i,r));break;case"rectangle":t.append(new f(i,r))}}return t}_updateViewInternal(){this._data=[];const t=this._provider.priceScale(),e=this._model.timeScale();if(!t||t.isEmpty()||e.isEmpty())return;const i=this._provider.graphics().textmarks();if(0===i.size)return;const r=this._model.timeScale().visibleBarsStrictRange();if(null===r)return;const o=this._provider.firstValue();if(null===o)return;const a=r.firstBar(),l=r.lastBar();i.forEach((i,r)=>{const c=this._provider.properties().graphics.textmarks[r];c.visible.value()&&i.forEach(i=>{let r=i.time;if(r<a||l<r)return;if(null===this._provider.series().bars().valueAt(r))return;r=i.time+(i.offset||0);const d={text:i.text?i.text:"",bold:c.fontBold.value(),italic:c.fontItalic.value(),font:c.fontFamily.value(),fontColor:Object(x.generateColor)(c.fontColor.value(),c.transparency.value()),fontSize:c.fontSize.value()},h=c.location.value(),u=c.shape.value();switch(u){case s.a.Triangle:{const{x:s,y:a,direction:l}=this._calcCoordsForTriangleShape(h,r,50,i.price,o,t,e);this._data.push(Object.assign({shape:u,color:Object(x.generateColor)(c.color.value(),c.transparency.value()),borderColor:"rgb(0, 0, 0)",direction:l,point:new n.Point(s,a),halign:c.halign.value(),size:.5*e.barSpacing()},d))}break;case s.a.Rectangle:{const{x:s,y:a}=this._calcCoordsForRectangleShape(h,r,i.price,o,t,e);this._data.push(Object.assign({shape:u,point:new n.Point(s,a),halign:c.halign.value(),valign:void 0!==c.valign?c.valign.value():"middle"},d))}}
this._textCache.push({})})})}_calcCoordsForTriangleShape(t,e,i,n,s,a,l){const c=Math.round(l.indexToCoordinate(e));switch(t){case o.MarkLocation.Top:return{x:c,y:a.height()-i,direction:"down"};case o.MarkLocation.Bottom:return{x:c,y:i,direction:"up"};case o.MarkLocation.AbsoluteDown:return{x:c,y:a.priceToCoordinate(Object(r.ensureDefined)(n),s),direction:"down"};case o.MarkLocation.AbsoluteUp:return{x:c,y:a.priceToCoordinate(Object(r.ensureDefined)(n),s),direction:"up"};case o.MarkLocation.AboveBar:return{x:c,y:this._locationToY(t,e),direction:"down"};case o.MarkLocation.BelowBar:default:return{x:c,y:this._locationToY(t,e),direction:"up"}}}_calcCoordsForRectangleShape(t,e,i,n,s,a){const l=Math.round(a.indexToCoordinate(e));switch(t){case o.MarkLocation.AbsoluteDown:case o.MarkLocation.AbsoluteUp:case o.MarkLocation.Absolute:return{x:l,y:s.priceToCoordinate(Object(r.ensureDefined)(i),n)};case o.MarkLocation.AboveBar:case o.MarkLocation.BelowBar:return{x:l,y:this._locationToY(t,e)};case o.MarkLocation.Right:case o.MarkLocation.Left:return{x:a.width(),y:s.priceToCoordinate(Object(r.ensureDefined)(i),n)};default:return{x:l,y:this._locationToY(t,e)}}}}},"3zbQ":function(t,e,i){"use strict";i.r(e),i.d(e,"LevelPaneView",(function(){return h}));var r=i("Eyy1"),n=i("aO4+"),o=i("VdBB"),s=i("VSsv"),a=i("Zy3/"),l=i("l4sv"),c=i("qgcf"),d=i("zDbI");class h{constructor(t,e,i){this._data=[],this._textData=[],this._invalidated=!0,this._provider=t,this._model=e}update(){this._invalidated=!0}renderer(){this._invalidated&&(this._updateViewInternal(),this._invalidated=!1);const t=new a.CompositeRenderer;for(const e of this._data){const i=new l.HorizontalLineRenderer;i.setData(e),t.append(i)}for(const e of this._textData)t.append(new c.TextRenderer(e,new o.HitTestResult(o.HitTestResult.REGULAR)));return t}_updateViewInternal(){this._calcHorzLinesData(),this._calcTextData()}_calcTextData(){this._textData=[];const t=this._provider.priceScale(),e=this._model.timeScale();if(!t||t.isEmpty()||e.isEmpty())return;const i=this._provider.graphics().hlines();if(0===i.size)return;const o=this._provider.firstValue();null!==o&&i.forEach((i,a)=>{const l=this._provider.properties().graphics.hlines[a];l.enableText.value()&&l.showText.value()&&i.forEach(i=>{const a=t.priceToCoordinate(Object(r.ensureDefined)(i.level),o),c=l.textPos.value(),[h,u]=function(t,e){if(t===s.a.TopLeft||t===s.a.MiddleLeft||t===s.a.BottomLeft)return["left",4];if(t===s.a.TopCenter||t===s.a.MiddleCenter||t===s.a.BottomCenter)return["center",e/2];if(t===s.a.TopRight||t===s.a.MiddleRight||t===s.a.BottomRight)return["right",e];throw new Error("Unsupported TextPos value")}(c,e.width()),[p,f]=function(t,e){if(t===s.a.TopLeft||t===s.a.TopCenter||t===s.a.TopRight)return["bottom",e-4];if(t===s.a.MiddleLeft||t===s.a.MiddleCenter||t===s.a.MiddleRight)return["middle",e-2];if(t===s.a.BottomLeft||t===s.a.BottomCenter||t===s.a.BottomRight)return["top",e];throw new Error("Unsupported TextPos value")}(c,a);this._textData.push({points:[new n.Point(u,f)],offsetX:0,offsetY:0,text:i.text||"",
color:l.color.value(),font:d.CHART_FONT_FAMILY,fontsize:l.fontSize.value(),horzAlign:h,vertAlign:p})})})}_calcHorzLinesData(){this._data=[];const t=this._provider.priceScale(),e=this._model.timeScale();if(!t||t.isEmpty()||e.isEmpty())return;const i=this._provider.graphics().hlines();if(0===i.size)return;const n=this._provider.firstValue();null!==n&&i.forEach((e,i)=>{const o=this._provider.properties().graphics.hlines[i];o.visible.value()&&e.forEach(e=>{const i=t.priceToCoordinate(Object(r.ensureDefined)(e.level),n);this._data.push({visible:!0,y:i,color:o.color.value(),linewidth:o.width.value(),linestyle:o.style.value()})})})}}},BJvp:function(t,e,i){"use strict";i.r(e),i.d(e,"PolygonPaneView",(function(){return c}));var r=i("Eyy1"),n=i("aO4+"),o=i("VdBB"),s=i("Zy3/"),a=i("8Uy/"),l=i("BCbF");class c{constructor(t,e,i){this._data=[],this._invalidated=!0,this._provider=t,this._model=e,this._hitTestResult=void 0!==i?new o.HitTestResult(o.HitTestResult.CUSTOM,i):new o.HitTestResult(o.HitTestResult.REGULAR)}update(){this._invalidated=!0}renderer(){this._invalidated&&(this._updateViewInternal(),this._invalidated=!1);const t=new s.CompositeRenderer;for(const e of this._data){const i=new l.PolygonRenderer(this._hitTestResult);i.setData(e),t.append(i)}return t}_updateViewInternal(){this._data=[];const t=this._provider.priceScale(),e=this._model.timeScale();if(!t||t.isEmpty()||e.isEmpty())return;const i=this._provider.graphics().polygons();if(0===i.size)return;const o=this._model.timeScale().visibleBarsStrictRange();if(null===o)return;const s=this._provider.firstValue();if(null===s)return;const l=o.firstBar(),c=o.lastBar(),d=this._provider.properties().graphics.polygons,h=Object(r.ensureDefined)(this._provider.metaInfo().graphics.polygons);i.forEach((i,o)=>{const u=d[o];100!==u.transparency.value()&&i.forEach(i=>{let d=1/0,p=-1/0;for(const t of i.points){const e=t.index+(t.offset||0);d=Math.min(d,e),p=Math.max(p,e)}if(p<l||c<d)return;const f=i.points.map(i=>{const o=e.indexToCoordinate(i.index+(i.offset||0)),a=t.priceToCoordinate(Object(r.ensureDefined)(i.level),s);return new n.Point(o,a)});this._data.push({points:f,color:u.color.value(),backcolor:u.color.value(),linewidth:void 0!==u.showBorder&&u.showBorder.value()?1:0,linestyle:a.LINESTYLE_SOLID,filled:!0,fillBackground:!0,transparency:u.transparency.value(),mouseTouchable:Object(r.ensureDefined)(h[o]).mouseTouchable})})})}}},Gj0v:function(t,e,i){"use strict";i.r(e);var r=i("Eyy1"),n=i("VdBB"),o=i("Zy3/"),s=i("qgcf"),a=i("aO4+"),l=i("eJTA"),c=i("ikwP"),d=i("KG+6"),h=i("nEwK"),u=i("zDbI");function p(t,e){return{min:Math.min(t,e),max:Math.max(t,e)}}function f(t){return t.max-t.min}class _{constructor(t){this._data=t}hitTest(t,e){const i=this._data;for(const r of i.histograms){if(r.xRange.min>=t.x||t.x>=r.xRange.max||r.yRange.min>=t.y||t.y>=r.yRange.max)continue;let o=r.yRange.min,s=0;r.bars.forEach(t=>{const e=t.subBarValues.reduce((t,e)=>t+e);s=Math.max(s,e)});const a=f(r.xRange);for(const l of r.bars){const c=i.styles[l.styleId];if(!c.visible)return null
;const d=g(r.xRange,c,e.cssWidth),{xBasePoint:h,sign:u}=d,f=p(o,o+l.height);o+=l.height;const _=Math.max(c.percentWidth*a/100-l.subBarValues.length,0);for(let e=0;e<l.subBarValues.length;e++){const i=f.min,r=f.max,o=0===e?h:h+u*(_*l.subBarValues[e-1]/s),a=o+u*(_*l.subBarValues[e]/s);if((t.x>=o&&t.x<=a||t.x>=a&&t.x<=o)&&t.y>=i&&t.y<=r)return new n.HitTestResult(n.HitTestResult.REGULAR)}}}return null}draw(t,e){const i=this._data;t.save(),i.histograms.forEach(r=>{const n=[];let o=r.yRange.min,s=0,a=0;r.bars.forEach(t=>{const e=t.subBarValues.reduce((t,e)=>t+e);s=Math.max(s,e),a+=t.height});const c=a/r.bars.length,d=(h=c,u=e.pixelRatio,Math.floor(h*u)>=1*u?Math.floor(u):0);var h,u;const _=f(r.xRange),b=[];if(r.bars.forEach(a=>{const l=i.styles[a.styleId];if(!l.visible)return;if(l.showValues)for(let t=0;t<a.subBarValues.length;t++)n[t]=(n[t]||0)+a.subBarValues[t];const c=g(r.xRange,l,e.cssWidth),{xBasePoint:h,sign:u}=c,f=p(o,o+a.height);if(o+=a.height,f.min>e.cssHeight||f.max<0)return;const w=Math.max(l.percentWidth*_/100-a.subBarValues.length,0);for(let i=0;i<a.subBarValues.length;i++){const r=f.min,n=f.max,o=0===i?h:h+u*(w*a.subBarValues[i-1]/s),c=o+u*(w*a.subBarValues[i]/s);if(Math.abs(c-o)<.5)continue;t.fillStyle=l.colors[i],t.beginPath();const p=Math.round(o*e.pixelRatio),_=Math.round(r*e.pixelRatio),g=Math.round(c*e.pixelRatio),x=Math.round(n*e.pixelRatio),v=g-p,b=Math.max(x-_-d,1);t.rect(p,_,v,b),t.fill()}if(!l.showValues)return;const m=x(a.subBarValues,l.direction),y=v(_,f,c,l,m);b.push(y)}),b.length>0){const t=i.styles[r.bars[0].styleId],s=g(r.xRange,t,e.cssWidth),a=p(o,o+c),d=x(n,t.direction),h=v(_,a,s,t,d);h.color=Object(l.shiftColor)(h.color,1.5),b.push(h)}const m=Math.min(...b.map(t=>t.fontSize));if(m>=7.5)for(const i of b)i.fontSize=m,w(t,e,i)}),t.restore()}}function g(t,e,i){const r=e.location===d.b.Absolute,n=e.location===d.b.Relative,o=e.direction===d.a.LeftToRight,s=e.direction===d.a.RightToLeft;let a,l;if(r&&o)a=t.min,l=1;else if(r&&s)a=t.max,l=-1;else if(n&&o)a=0,l=1;else{if(!n||!s)throw new Error(`Unknown location/direction values: ${e.location}/${e.direction}`);a=i,l=-1}return{xBasePoint:a,sign:l}}function x(t,e){e===d.a.RightToLeft&&(t=t.slice()).reverse();const i=new h.VolumeFormatter;return t.map(t=>i.format(t)).join("x")}function v(t,e,i,r,n){const o=Math.min(Math.round(1.7*t/n.length),Math.round(.6*f(e))),s=r.direction===d.a.LeftToRight?"left":"right",{xBasePoint:l,sign:c}=i,h=l+3*c,u=e.min+.7*f(e);return{text:n,color:r.valuesColor,fontSize:o,align:s,point:new a.Point(h,u)}}function w(t,e,i){const{text:r,color:n,fontSize:o,align:s,point:a}=i;t.font=`${o}px ${u.CHART_FONT_FAMILY}`,t.fillStyle=n,t.textAlign=s,Object(c.drawScaled)(t,e.pixelRatio,()=>t.fillText(r,a.x,a.y))}var b=i("Tmoa");i.d(e,"HHistPaneView",(function(){return m}));class m{constructor(t,e,i){this._invalidated=!0,this._provider=t,this._model=e,this._rendererData={histograms:[],styles:{}},this._textData=[],this._hhistRenderer=new _(this._rendererData)}update(){this._invalidated=!0}renderer(){
this._invalidated&&(this._updateViewInternal(),this._invalidated=!1);const t=new o.CompositeRenderer;t.append(this._hhistRenderer);for(const e of this._textData)t.append(new s.TextRenderer(e,new n.HitTestResult(n.HitTestResult.REGULAR)));return t}_resetRenderersData(){this._rendererData.histograms=[],this._textData=[]}_prepareStyles(){const t=Object(r.ensureDefined)(this._provider.graphicsInfo().hhists),e=Object.keys(t),i=this._provider.properties().graphics.hhists;this._rendererData.styles={};for(const n of e){const e=Object(r.ensureDefined)(i.child(n)),o=Object(r.ensureDefined)(t[n]),s=Object(b.generateColor)(e.colors[0].value(),e.transparencies[0].value()),a=e.colors[1]?Object(b.generateColor)(e.colors[1].value(),e.transparencies[1].value()):s;this._rendererData.styles[n]={colors:[s,a],visible:e.visible.value(),percentWidth:e.percentWidth.value(),location:o.location,direction:e.direction.value(),showValues:e.showValues.value(),valuesColor:e.valuesColor.value()}}}_updateViewInternal(){this._resetRenderersData();const t=this._provider.priceScale(),e=this._model.timeScale();if(!t||t.isEmpty()||e.isEmpty())return;if(null===this._provider.firstValue())return;const i=this._provider.graphics().hhistsByTimePointIndex();if(0===i.size)return;const n=e.visibleBarsStrictRange();if(null===n)return;const o=n.firstBar(),s=n.lastBar();this._prepareStyles(),Object(r.ensureDefined)(i).forEach((i,r)=>{let n=1/0,a=-1/0;i.forEach(t=>{n=Math.min(n,t.firstBarTime),a=Math.max(a,t.lastBarTime)}),a<o||n>s||this._updateDataForRenderers(i,t,e)})}_updateDataForRenderers(t,e,i){if(t.size<=0)return;let n=null;if(t.forEach(t=>{n=n||t}),null===n)return;let o=n;t.forEach(t=>{t.priceLow<o.priceLow&&(o=t)});const s=function(t,e){return p(e.indexToCoordinate(t.firstBarTime),e.indexToCoordinate(t.lastBarTime))}(n,i),a=[];t.forEach(t=>{null==t.rate[t.rate.length-1]&&t.rate.splice(-1,1);const i=function(t,e,i){return p(e.priceToCoordinate(t.priceHigh,i),e.priceToCoordinate(t.priceLow,i))}(t,e,Object(r.ensureNotNull)(this._provider.firstValue()));a.push({yRange:i,subBarValues:t.rate,styleId:t.styleId})}),a.sort((t,e)=>t.yRange.min-e.yRange.min);const l=[];let c=a[0].yRange.min;for(const r of a){const t=r.yRange.max-c;l.push(Object.assign({height:t},r)),c=r.yRange.max}this._rendererData.histograms.push({xRange:s,yRange:p(a[0].yRange.min,c),bars:l})}}},IMGS:function(t,e,i){"use strict";var r=i("aB9a").LineSourcePaneView,n=i("rvCT").LinearRegressionPaneView,o=i("NN6M").ParallelChannelRenderer,s=i("qgcf").TextRenderer,a=i("pJOz").TrendLineRenderer,l=i("vq8G").SelectionRenderer,c=i("VdBB").HitTestResult,d=i("Zy3/").CompositeRenderer,h=i("Tmoa");e.RegressionTrendPaneView=class extends r{constructor(t,e){super(t,e),this._calc=null,this._lines=[],this._pearsons=null,this._pearsonsLabelRenderer=new s,this._renderer=null}getTransparencyResetLines(){return this._lines.map((function(t){var e=$.extend({},t);return e.color=h.resetTransparency(e.color),e}))}renderer(t,e){return this._invalidated&&this._updateImpl(),this._renderer}_updateImpl(){super._updateImpl(),
n.prototype._updateImpl.call(this),this._renderer=null;for(var t=new d,e=[],i=[this._lines[1],this._lines[0],this._lines[2]],r=[],s=0;s<i.length;s++)i[s]&&r.push(i[s]);for(s=1;s<r.length;s++){var u={};u.points=[i[s].floatPoints[0],i[s].floatPoints[1],i[s-1].floatPoints[0],i[s-1].floatPoints[1]],u.color=i[s].color,u.width=this._model.timeScale().width(),u.height=this._source.priceScale().height(),u.linewidth=i[s].linewidth,u.linestyle=i[s].linestyle,u.extendleft=!1,u.extendright=i[s].extendright,u.backcolor=u.color,u.transparency=this._source.properties().styles.transparency.value(),u.skipLines=!0,u.fillBackground=!0,(f=new o(new c(c.REGULAR))).setData(u),t.append(f)}var p=this.getTransparencyResetLines();for(s=0;s<r.length;s++){var f;(f=new a).setData(p[s]),f.setHitTest(new c(c.REGULAR)),t.append(f),0!==s&&(e=e.concat(this._lines[s].floatPoints))}if(this._pearsons&&(this._pearsons.color=h.resetTransparency(this._pearsons.color),this._pearsonsLabelRenderer.setData(this._pearsons),t.append(this._pearsonsLabelRenderer)),this._lines&&this._lines.length>=1){t.append(new l({points:e,bgColors:this._lineAnchorColors(e),visible:this.areAnchorsVisible()}));var _=this._lines[0].floatPoints;_[0].data=0,_[1].data=1,t.append(this.createLineAnchor({points:_}))}this._renderer=t}}},IyRz:function(t,e,i){"use strict";i.r(e);var r=i("Eyy1"),n=i("Zy3/"),o=i("ikwP"),s=i("Tmoa");class a{constructor(t){this._data=t}hitTest(t){return null}draw(t,e){}drawBackground(t,e){const i=this._data,r=Object(s.generateColor)(this._data.color,this._data.transparency),n=e.pixelRatio,a=Math.round(i.x1*n),l=Math.round(i.x2*n);Object(o.fillRect)(t,a,0,l-a,e.physicalHeight,r)}}i.d(e,"BackgroundPaneView",(function(){return l}));class l{constructor(t,e,i){this._data=[],this._invalidated=!0,this._provider=t,this._model=e,this._data=[]}update(){this._invalidated=!0}renderer(){this._invalidated&&(this._updateViewInternal(),this._invalidated=!1);const t=new n.CompositeRenderer;for(const e of this._data)t.append(new a(e));return t}_updateViewInternal(){this._data=[];const t=this._provider.priceScale(),e=this._model.timeScale();if(!t||t.isEmpty()||e.isEmpty())return;const i=this._provider.graphics().backgrounds();if(0===i.size)return;const n=this._model.timeScale().visibleBarsStrictRange();if(null===n)return;const o=n.firstBar(),s=n.lastBar();i.forEach((t,i)=>{const n=this._provider.properties().graphics.backgrounds[i];if(!n.visible.value())return;let a,l;t.forEach(t=>{const i=null!==t.start?t.start:Object(r.ensureNotNull)(e.points().firstIndex()),c=t.stop;if(c<o||s<i)return;let d=e.indexToCoordinate(i)-.5*e.barSpacing();const h=e.indexToCoordinate(c)+.5*e.barSpacing();l===i-1&&(d=a||d),a=h,l=c,d<0&&h<0||d>e.width()&&h>e.width()||this._data.push({x1:d,x2:h,color:n.color.value(),transparency:n.transparency.value()})})})}}},K3ps:function(t,e,i){"use strict";i.r(e);var r=i("Eyy1"),n=i("Zy3/"),o=i("PF2b"),s=i("Kmdw"),a=i("akof"),l=i("+q2u"),c=i("fxzW"),d=i("P+Pi"),h=i("IOzl"),u=i("aO4+"),p=i("jlDR");class f extends p.b{_calcBoundingBox(t){
const e=t.x,i=t.x+t.shapeWidth,r=t.y-t.shapeHeight+t.vertOffset,n=t.y+t.vertOffset,o=new u.Point(e,r),s=new u.Point(i,n);return Object(u.box)(o,s)}_drawItemShape(t,e,i){const r=e.pixelRatio,n=this._lineWidth(e)%2?.5:0,o=this._getArrowSize(i),s=Math.round(i.x*r)+n,a=Math.round((i.y+i.vertOffset)*r)+n,l=Math.round((i.x+o)*r)+n,c=Math.round((i.y+i.vertOffset-o)*r)+n,d=Math.round((i.y+i.vertOffset-2*o)*r)+n;t.moveTo(l,c),t.lineTo(s,a),t.lineTo(l,d);const h=Math.round((i.y+i.vertOffset-i.shapeHeight)*r)+n,u=Math.round((i.x+i.shapeWidth)*r)+n;this._drawCorner(t,l,h,p.a.leftUp,r),this._drawCorner(t,u,h,p.a.rightUp,r),this._drawCorner(t,u,c,p.a.rightDown,r),t.lineTo(l,c)}_getArrowSize(t){return t.stepX/Math.sqrt(2)}_getHorizontalTextOffset(t){return t.shapeWidth/2+this._getArrowSize(t)/2}_getVerticalTextOffset(t){return-t.shapeHeight/2-this._getArrowSize(t)/2}}class _ extends p.b{_calcBoundingBox(t){const e=t.x,i=t.x+t.shapeWidth,r=t.y+t.vertOffset,n=t.y+t.shapeHeight+t.vertOffset,o=new u.Point(e,r),s=new u.Point(i,n);return Object(u.box)(o,s)}_drawItemShape(t,e,i){const r=e.pixelRatio,n=this._lineWidth(e)%2?.5:0,o=this._getArrowSize(i),s=Math.round(i.x*r)+n,a=Math.round((i.y+i.vertOffset)*r)+n,l=Math.round((i.x+o)*r)+n,c=Math.round((i.y+i.vertOffset+2*o)*r)+n,d=Math.round((i.y+i.vertOffset+o)*r)+n,h=Math.round((i.x+i.shapeWidth)*r)+n,u=Math.round((i.y+i.vertOffset+i.shapeHeight)*r)+n;t.moveTo(l,c),t.lineTo(s,a),t.lineTo(l,d),this._drawCorner(t,h,d,p.a.rightUp,r),this._drawCorner(t,h,u,p.a.rightDown,r),this._drawCorner(t,l,u,p.a.leftDown,r),t.lineTo(l,c)}_getArrowSize(t){return t.stepX/Math.sqrt(2)}_getHorizontalTextOffset(t){return t.shapeWidth/2+this._getArrowSize(t)/2}_getVerticalTextOffset(t){return t.shapeHeight/2+this._getArrowSize(t)/2}}class g extends p.b{_calcBoundingBox(t){const e=t.x-t.shapeWidth,i=t.x,r=t.y-t.shapeHeight+t.vertOffset,n=t.y+t.vertOffset,o=new u.Point(e,r),s=new u.Point(i,n);return Object(u.box)(o,s)}_drawItemShape(t,e,i){const r=e.pixelRatio,n=this._lineWidth(e)%2?.5:0,o=this._getArrowSize(i),s=Math.round(i.x*r)+n,a=Math.round((i.y+i.vertOffset)*r)+n,l=Math.round((i.x-o)*r)+n,c=Math.round((i.y+i.vertOffset-2*o)*r)+n,d=Math.round((i.y+i.vertOffset-o)*r)+n,h=Math.round((i.x-i.shapeWidth)*r)+n,u=Math.round((i.y+i.vertOffset-i.shapeHeight)*r)+n;t.moveTo(l,c),t.lineTo(s,a),t.lineTo(l,d),this._drawCorner(t,h,d,p.a.leftDown,r),this._drawCorner(t,h,u,p.a.leftUp,r),this._drawCorner(t,l,u,p.a.rightUp,r),t.lineTo(l,c)}_getArrowSize(t){return t.stepX/Math.sqrt(2)}_getVerticalTextOffset(t){return-t.shapeHeight/2-this._getArrowSize(t)/2}_getHorizontalTextOffset(t){return-t.shapeWidth/2-this._getArrowSize(t)/2}}class x extends p.b{_calcBoundingBox(t){const e=t.x-t.shapeWidth,i=t.x,r=t.y+t.vertOffset,n=t.y+t.shapeHeight+t.vertOffset,o=new u.Point(e,r),s=new u.Point(i,n);return Object(u.box)(o,s)}_drawItemShape(t,e,i){
const r=e.pixelRatio,n=this._lineWidth(e)%2?.5:0,o=this._getArrowSize(i),s=Math.round(i.x*r)+n,a=Math.round((i.y+i.vertOffset)*r)+n,l=Math.round((i.x-o)*r)+n,c=Math.round((i.y+i.vertOffset+o)*r)+n,d=Math.round((i.y+i.vertOffset+2*o)*r)+n,h=Math.round((i.x-i.shapeWidth)*r)+n,u=Math.round((i.y+i.vertOffset+i.shapeHeight)*r)+n;t.moveTo(l,c),t.lineTo(s,a),t.lineTo(l,d),this._drawCorner(t,l,u,p.a.rightDown,r),this._drawCorner(t,h,u,p.a.leftDown,r),this._drawCorner(t,h,c,p.a.leftUp,r),t.lineTo(l,c)}_getArrowSize(t){return t.stepX/Math.sqrt(2)}_getHorizontalTextOffset(t){return-t.shapeWidth/2-this._getArrowSize(t)/2}_getVerticalTextOffset(t){return t.shapeHeight/2+this._getArrowSize(t)/2}}var v=i("6ptY"),w=i("V0al"),b=i("2WC2"),m=i("gBDZ");class y extends b.a{setData(t,e){this._setBaseData(t,e);for(const i of this._items)0===i.vertOffset&&(i.textVertOffset=0)}_drawItemText(t,e,i){var r;const n=this._getTextCache(i);if(null===n)return;const o=i.x,s=i.y+i.textVertOffset,a=(null===(r=i.style)||void 0===r?void 0:r.textColor)||this._textColor,l=i.vertOffset;n.paintTo(t,e,a,o,s,m.a.Center,l>0?m.c.Top:m.c.Bottom)}_calcBoundingBox(t){const e=t.vertOffset,i=this._getTextCache(t);if(!i)return;const r=i.textImageWidth,n=i.textImageHeight,o=r/2,s=t.y+t.textVertOffset,a=e>0?0:-n,l=e>0?n:0,c=new u.Point(t.x-o,s+a),d=new u.Point(t.x+o,s+l);return Object(u.box)(c,d)}}var T=i("vaiT"),R=i("tS10"),P=i("Tmoa"),C=i("C9nU");i.d(e,"DwgLabelPaneView",(function(){return S}));const O={[T.b.Left]:"left",[T.b.Center]:"center",[T.b.Right]:"right"};class S{constructor(t,e,i){this._rendererTypeByStyle=new Map([[T.a.Arrowdown,s.a],[T.a.Arrowup,s.b],[T.a.Circle,a.a],[T.a.Cross,l.a],[T.a.Diamond,c.a],[T.a.Flag,d.a],[T.a.LabelDown,h.b],[T.a.LabelUp,h.e],[T.a.LabelLeft,h.c],[T.a.LabelRight,h.d],[T.a.LabelCenter,h.a],[T.a.LabelLeftUp,_],[T.a.LabelLeftDown,f],[T.a.LabelRightUp,x],[T.a.LabelRightDown,g],[T.a.Square,v.a],[T.a.Triangleup,o.b],[T.a.Triangledown,o.a],[T.a.Xcross,w.a],[T.a.None,y]]),this._invalidated=!0,this._graphicsProvider=t,this._model=e,this._renderer=new n.CompositeRenderer,this._textCache=new R.a(5e3)}update(){this._invalidated=!0}renderer(){return this._invalidated&&(this._invalidated=!1,this._updateViewInternal(this._model.timeScale().barSpacing())),this._renderer}_updateViewInternal(t){this._renderer.clear();const e=this._graphicsProvider.priceScale(),i=this._model.timeScale();if(!e||e.isEmpty()||i.isEmpty())return;const n=this._graphicsProvider.graphics().dwglabels(),o=i.visibleBarsStrictRange(),s=this._graphicsProvider.firstValue();if(0===n.size||null===o||null===s)return;const a=o.firstBar(),l=o.lastBar(),c=Math.round(t*C.a.AUTO_SIZE_MULT);let d=null;const h=[];n.forEach((t,i)=>{this._graphicsProvider.properties().graphics.dwglabels[i].visible.value()&&t.forEach(t=>{const i=t.x;if(i<a||l<i)return;let r,n;if(this._graphicsProvider.metaInfo().isRGB)r=null===t.colorIndex?void 0:Object(P.rgbaFromInteger)(t.colorIndex),n=null===t.textColorIndex?void 0:Object(P.rgbaFromInteger)(t.textColorIndex);else{
const e=this._graphicsProvider.properties().palettes;if(void 0===e||void 0===e.palette_common)return;const i=e.palette_common,o=null===t.colorIndex?null:i.colors[t.colorIndex],s=null===t.textColorIndex?null:i.colors[t.textColorIndex];if(void 0===o||void 0===s)return;r=null===o?void 0:o.color.value(),n=null===s?void 0:s.color.value()}if(void 0===r&&void 0===n)return;const o=t.size,u=t.style,p=Object(C.d)(C.a.NORMAL_SIZE,o,c),f=this._getInvertedYloc(t.yloc,e.isInverted()),_=void 0===n?"":t.text,g=O[t.textAlign],x=t.tooltip,v=this._getLocationData({index:i,price:t.y,yloc:f,size:p,style:u,firstValue:s,hideShape:void 0===r}),w={x:v.x0,y:v.y0,width:v.shapeWidth,height:v.shapeHeight,vertOffset:v.vertOffset,text:_,fontSize:v.fontSize,style:{color:r,borderColor:r,textColor:n},textAlign:g,tooltip:x};let b;v.style!==d?(b={items:[],style:v.style},h.push(b),d=v.style):b=h[h.length-1],b.items.push(w)})}),h.forEach(e=>{const i=new(Object(r.ensureDefined)(this._rendererTypeByStyle.get(e.style)))({items:e.items,barSpacing:t},{textCache:this._textCache,skipRenderingOptimizations:!0});this._renderer.append(i)})}_getLocationData(t){const e=C.a,i=t.size*e.FONT_SIZE_MULT,r=this._model.timeScale(),n=this._graphicsProvider.priceScale(),o=r.indexToCoordinate(t.index);let s=NaN;if(t.yloc===T.c.Price)s=n.priceToCoordinate(t.price,t.firstValue);else{const e=t.yloc===T.c.AboveBar?2:3,i=this._graphicsProvider.series().bars().valueAt(t.index);if(null!==i){const r=i[e];null!=r&&(s=n.priceToCoordinate(r,t.firstValue))}}const a=t.size*e.SHAPE_WIDTH_MULT,l=t.size*e.SHAPE_HEIGHT_MULT;return{x0:o,y0:s,shapeWidth:a,shapeHeight:l,vertOffset:-1.5*l*this._getYLocSign(t.yloc),fontSize:i,style:t.hideShape?T.a.None:t.style}}_getYLocSign(t){return t===T.c.Price?0:t===T.c.AboveBar?1:-1}_getInvertedYloc(t,e){if(e){if(t===T.c.AboveBar)return T.c.BelowBar;if(t===T.c.BelowBar)return T.c.AboveBar}return t}}},Kt0C:function(t,e,i){"use strict";i.r(e),i.d(e,"LinePaneView",(function(){return c}));var r=i("Eyy1"),n=i("aO4+"),o=i("VdBB"),s=i("Zy3/"),a=i("a7Ha"),l=i("pJOz");class c{constructor(t,e,i){this._data=[],this._invalidated=!0,this._provider=t,this._model=e,this._hitTestResult=void 0!==i?new o.HitTestResult(o.HitTestResult.CUSTOM,i):new o.HitTestResult(o.HitTestResult.REGULAR)}update(){this._invalidated=!0}renderer(){this._invalidated&&(this._updateViewInternal(),this._invalidated=!1);const t=new s.CompositeRenderer;for(const e of this._data){const i=new l.TrendLineRenderer;i.setData(e),i.setHitTest(this._hitTestResult),t.append(i)}return t}_updateViewInternal(){this._data=[];const t=this._provider.priceScale(),e=this._model.timeScale();if(!t||t.isEmpty()||e.isEmpty())return;const i=this._provider.graphics().lines();if(0===i.size)return;const o=this._model.timeScale().visibleBarsStrictRange();if(null===o)return;const s=this._provider.firstValue();if(null===s)return;const l=o.firstBar(),c=o.lastBar();i.forEach((i,o)=>{const d=this._provider.properties().graphics.lines[o];d.visible.value()&&i.forEach(i=>{
const o=i.startIndex+(i.startOffset||0),h=i.endIndex+(i.endOffset||0);if(Math.max(o,h)<l||Math.min(o,h)>c)return;const u=e.indexToCoordinate(o),p=e.indexToCoordinate(h),f=t.priceToCoordinate(Object(r.ensureDefined)(i.startPrice),s),_=t.priceToCoordinate(Object(r.ensureDefined)(i.endPrice),s),g=new n.Point(u,f),x=new n.Point(p,_);this._data.push({points:[g,x],extendleft:!1,extendright:!1,leftend:a.LineEnd.Normal,rightend:a.LineEnd.Normal,color:d.color.value(),linewidth:d.width.value(),linestyle:d.style.value()})})})}}},N1nd:function(t,e,i){"use strict";i.r(e);var r=i("aO4+"),n=i("Tmoa"),o=i("tSCe"),s=i.n(o),a=i("9/CJ"),l=i("f6yo"),c=i("VdBB"),d=i("gAom"),h=i("8Uy/");class u{constructor(t){this._locs=t}draw(t,e){t.lineCap="butt";const i=Math.max(1,Math.floor(e.pixelRatio));this._locs.forEach(r=>{const n=Math.round(r.leftTop.x*e.pixelRatio),o=Math.round(r.leftTop.y*e.pixelRatio),s=Math.round(r.rightBottom.x*e.pixelRatio),a=Math.round(r.rightBottom.y*e.pixelRatio),l=r.style,c=Math.round(l.borderWidth*e.pixelRatio);Object(d.fillRectWithBorder)(t,n,o,s,a,l.backgroundColor,l.borderColor,c,h.LINESTYLE_SOLID,l.extendLeft,l.extendRight,"inner",e.physicalWidth,1===i?1:0,l.dashPattern)})}hitTest(t){for(const e of this._locs)if(Object(l.pointInBox)(t,Object(r.box)(e.leftTop,e.rightBottom)))return new c.HitTestResult(c.HitTestResult.REGULAR);return null}}i.d(e,"getDwgBoxDrawPattern",(function(){return f})),i.d(e,"DwgBoxPaneView",(function(){return _}));const p=new Map([[a.b.Solid,[]],[a.b.Dashed,[5,6]],[a.b.Dotted,[1,2]]]);function f(t){const e=p.get(t);if(void 0===e)throw new Error("Unsupported box style: "+t);return e}class _ extends s.a{constructor(t,e,i){super(),this._invalidated=!0,this._graphicsProvider=t,this._model=e,this._renderer=null}update(){this._invalidated=!0}renderer(){return this._invalidated&&(this._renderer=null,this._invalidated=!1,this._updateRenderer()),this._renderer}_updateRenderer(){const t=this._graphicsProvider.priceScale(),e=this._model.timeScale();if(!t||t.isEmpty()||e.isEmpty())return;const i=this._graphicsProvider.graphics().dwgboxes();if(0===i.size)return;if(null===this._model.timeScale().visibleBarsStrictRange())return;const o=this._graphicsProvider.properties().palettes,s=this._graphicsProvider.metaInfo().isRGB;if(!s&&(void 0===o||void 0===o.palette_common))return;const l=o.palette_common,c=this._graphicsProvider.firstValue();if(null===c)return;const d=e.width(),h=t.height(),p=[];i.forEach((i,o)=>{this._graphicsProvider.properties().graphics.dwgboxes[o].visible.value()&&i.forEach(i=>{if(null===i.backgroundColorIndex&&null===i.borderColorIndex)return;let o,u;if(s?(o=null===i.backgroundColorIndex?void 0:Object(n.rgbaFromInteger)(i.backgroundColorIndex),u=null===i.borderColorIndex?void 0:Object(n.rgbaFromInteger)(i.borderColorIndex)):(o=null!==i.backgroundColorIndex?l.colors[i.backgroundColorIndex].color.value():void 0,u=null!==i.borderColorIndex?l.colors[i.borderColorIndex].color.value():void 0),void 0===o&&void 0===u)return
;const _=e.indexToCoordinate(i.left),g=e.indexToCoordinate(i.right),x=Math.min(_,g),v=Math.max(_,g),w=t.priceToCoordinate(i.top,c),b=t.priceToCoordinate(i.bottom,c),m=Math.min(w,b),y=Math.max(w,b),T={borderWidth:i.borderWidth,borderColor:u,backgroundColor:o,dashPattern:f(i.borderStyle),extendLeft:i.extend===a.a.Left||i.extend===a.a.Both,extendRight:i.extend===a.a.Right||i.extend===a.a.Both},R={leftTop:new r.Point(Math.min(x,v),m),rightBottom:new r.Point(Math.max(x,v),y),style:T},P=R.rightBottom.x<-R.style.borderWidth&&!R.style.extendRight,C=R.leftTop.x>d+R.style.borderWidth&&!R.style.extendLeft,O=R.rightBottom.y<-R.style.borderWidth,S=R.leftTop.y>h+R.style.borderWidth;P||C||O||S||p.push(R)})}),this._renderer=new u(p)}}},PztT:function(t,e,i){"use strict";i.r(e);var r=i("aO4+"),n=i("tSCe"),o=i.n(n),s=i("2tp3"),a=i("GEp6"),l=i("VdBB"),c=i("jFln"),d=i("Zp/P"),h=i("ikwP");function u(t){return t*this.width}class p{constructor(t){this._locs=t}draw(t,e){t.lineCap="butt",Object(h.drawScaled)(t,e.pixelRatio,()=>{this._locs.forEach(e=>{const i=e.style,r=i.type.dashPattern.map(u,i);t.strokeStyle=i.color,t.lineWidth=i.width,Object(c.setLineDash)(t,r),t.beginPath(),this._drawShape(t,e),t.stroke()})})}hitTest(t){for(const e of this._locs){const i=e.style.width/2;if(Object(a.distanceToSegment)(e.extP1,e.extP2,t).distance<=i)return new l.HitTestResult(l.HitTestResult.REGULAR)}return null}_drawShape(t,e){t.moveTo(e.extP1.x,e.extP1.y),t.lineTo(e.extP2.x,e.extP2.y);const i=e.style.width;e.style.type.drawLeftArrow&&this._drawArrow(t,e.p2,e.p1,i),e.style.type.drawRightArrow&&this._drawArrow(t,e.p1,e.p2,i)}_drawArrow(t,e,i,r){if(i.subtract(e).length()<1)return;const n=Object(d.getArrowPoints)(e,i,r,!0);for(const o of n)t.moveTo(o[0].x,o[0].y),t.lineTo(o[1].x,o[1].y)}}var f=i("hBTJ"),_=i("Tmoa");function g(t,e,i){const r=function(t,e,i){const r=e.subtract(t);return i.subtract(t).dotProduct(r)/r.dotProduct(r)}(t.extP1,t.extP2,e),n=t.extP1.add(t.extP2.subtract(t.extP1).scaled(r));r<0&&i.left?t.extP1=n:r>1&&i.right&&(t.extP2=n)}i.d(e,"DwgLinePaneView",(function(){return x}));class x extends o.a{constructor(t,e,i){super(),this._invalidated=!0,this._graphicsProvider=t,this._model=e,this._renderer=null}update(){this._invalidated=!0}renderer(){return this._invalidated&&(this._renderer=null,this._invalidated=!1,this._updateRenderer()),this._renderer}_updateRenderer(){const t=this._graphicsProvider.priceScale(),e=this._model.timeScale();if(!t||t.isEmpty()||e.isEmpty())return;const i=this._graphicsProvider.graphics().dwglines();if(0===i.size)return;if(null===this._model.timeScale().visibleBarsStrictRange())return;const n=this._graphicsProvider.firstValue();if(null===n)return;const o=e.width(),a=t.height(),l=[];i.forEach((i,c)=>{this._graphicsProvider.properties().graphics.dwglines[c].visible.value()&&i.forEach(i=>{if(null===i.colorIndex)return;let c;if(this._graphicsProvider.metaInfo().isRGB)c=Object(_.rgbaFromInteger)(i.colorIndex);else{const t=this._graphicsProvider.properties().palettes;if(void 0===t||void 0===t.palette_common)return
;c=t.palette_common.colors[i.colorIndex].color.value()}if(void 0===c)return;const d=e.indexToCoordinate(i.x1),h=t.priceToCoordinate(i.y1,n),u=e.indexToCoordinate(i.x2),p=t.priceToCoordinate(i.y2,n),f={width:i.width>0?i.width:1,color:c,type:Object(s.c)(i.style)},g=this._getLocationData(new r.Point(d,h),new r.Point(u,p),i.extend,o,a,f);null!==g&&l.push(g)})}),this._renderer=new p(l)}_getLocationData(t,e,i,n,o,a){const l=function(t){return{left:t===s.a.Both||t===s.a.Left,right:t===s.a.Both||t===s.a.Right}}(i),c={p1:t,p2:e,extP1:t,extP2:e,style:a};l.left&&!l.right&&(c.extP1=e,c.extP2=t,l.left=!1,l.right=!0);const d=[new r.Point(0,0),new r.Point(0,o),new r.Point(n,o),new r.Point(n,0)];!function(t,e,i){for(const r of e)g(t,r,i)}(c,d,l);const h=function(t,e,i){const r=.5*i,n=e.subtract(t).normalized().transposed().scaled(r),o=t.add(n),s=e.add(n),a=t.subtract(n);return[o,s,e.subtract(n),a]}(c.extP1,c.extP2,a.width);return null===Object(f.intersectPolygons)(d,h)?null:c}}},XlJ7:function(t,e,i){"use strict";function r(t,e,i,r){return`${r?r+" ":""}${i?i+" ":""}${t}px ${e}`}i.r(e),i.d(e,"makeFont",(function(){return r})),i.d(e,"parseFont",(function(){return o}));const n=/(bold )?(italic )?(\d+)(px|pt) (.*)$/;function o(t){const e=n.exec(t);return null===e?null:{family:e[5],size:parseInt(e[3])*("pt"===e[4]?.75:1),bold:Boolean(e[1]),italic:Boolean(e[2])}}},"Zp/P":function(t,e,i){"use strict";i.r(e),i.d(e,"extendAndClipLineSegment",(function(){return d})),i.d(e,"getArrowPoints",(function(){return h})),i.d(e,"optimalBarWidth",(function(){return u})),i.d(e,"optimalCandlestickWidth",(function(){return p})),i.d(e,"optimalHiLoWidth",(function(){return f})),i.d(e,"interactionTolerance",(function(){return _})),i.d(e,"coordinateIsValid",(function(){return g})),i.d(e,"setValidLineStyle",(function(){return x})),i.d(e,"fillScaledRadius",(function(){return v})),i.d(e,"strokeScaledRadius",(function(){return w}));var r=i("aO4+"),n=i("hBTJ"),o=i("VaSN"),s=i("ogJP"),a=i("jFln");const l={line:13,minDistanceBetweenPoints:10,series:14,curve:10,anchor:13,esd:4},c={line:3,minDistanceBetweenPoints:5,series:2,curve:3,anchor:2,esd:0};function d(t,e,i,o,s,a){if(Object(r.equalPoints)(t,e))return null;const l=new r.Point(0,0),c=new r.Point(i,o);if(s){if(a){const i=Object(n.intersectLineAndBox)(Object(r.lineThroughPoints)(t,e),Object(r.box)(l,c));return Array.isArray(i)?i:null}{const i=Object(n.intersectRayAndBox)(e,t,Object(r.box)(l,c));return null===i||Object(r.equalPoints)(e,i)?null:Object(r.lineSegment)(e,i)}}if(a){const i=Object(n.intersectRayAndBox)(t,e,Object(r.box)(l,c));return null===i||Object(r.equalPoints)(t,i)?null:Object(r.lineSegment)(t,i)}{const i=Object(n.intersectLineSegmentAndBox)(Object(r.lineSegment)(t,e),Object(r.box)(l,c));return Array.isArray(i)?i:null}}function h(t,e,i,r){const n=.5*i,o=Math.sqrt(2),s=e.subtract(t),a=s.normalized();let l=5*i;r&&(l=Math.min(l,.35*s.length()));const c=1*n;if(l*o*.2<=c)return[]
;const d=a.scaled(l),h=e.subtract(d),u=a.transposed(),p=1*l,f=u.scaled(p),_=h.add(f),g=h.subtract(f),x=_.subtract(e).normalized().scaled(c),v=g.subtract(e).normalized().scaled(c),w=e.add(x),b=e.add(v),m=n*(o-1),y=u.scaled(m),T=Math.min(l-1*n/o,n*o*1),R=a.scaled(T),P=e.subtract(y),C=e.add(y),O=e.subtract(R);return[[_,w],[g,b],[P,O.subtract(y)],[C,O.add(y)]]}function u(t,e){return e=e||1,Math.floor(.3*t*e)}function p(t,e){if(t>=2.5&&t<=4)return Math.floor(3*e);const i=1-.2*Math.atan(Math.max(4,t)-4)/(.5*Math.PI),r=Math.floor(t*i*e),n=Math.floor(t*e),o=Math.min(r,n);return Math.max(Math.floor(e),o)}function f(t){return.4*t}function _(){return Object(o.lastEventIsTouch)()?l:c}function g(t){return null!=t&&!Object(s.isNaN)(t)}function x(t,e){void 0!==e&&Object(a.setLineStyle)(t,e)}function v(t,e){const i=Math.max(1,Math.floor(e))%2?.5:0;return Math.round(t*e)+i}function w(t,e,i){const r=Math.max(1,Math.floor(e))%2?.5:0;return Math.round(t*e)+(r!==i%2?.5:0)}},aS5C:function(t,e,i){"use strict";i.r(e);var r=i("Zy3/"),n=i("Tmoa"),o=i("Eyy1"),s=i("aO4+"),a=i("zDbI"),l=i("VdBB"),c=i("IjC5"),d=i("qgcf"),h=i("u+0B"),u=i("XlJ7"),p=i("23IT");const f=new Map;function _(t,e,i,r){const n=new d.TextRenderer;e.cells.forEach(e=>{const l=i.position.x+i.columnsOffsets[e.cell.column],c=i.position.y+i.rowsOffsets[e.cell.row],d=function(t,e,i,r,n){let l=t,c="left";"center"===n.cell.horizontalTextAlignment?(c="center",l+=i/2):"right"===n.cell.horizontalTextAlignment&&(c="right",l+=i-1);let d=e,h="top";return"center"===n.cell.verticalTextAlignment?(h="middle",d+=r/2):"bottom"===n.cell.verticalTextAlignment&&(h="bottom",d+=r-1),{points:[new s.Point(l,d)],text:n.cell.text,color:n.style.textColor,vertAlign:h,horzAlign:c,font:a.CHART_FONT_FAMILY,fontSize:Object(o.ensureDefined)(f.get(n.cell.fontSize)),offsetX:0,offsetY:0}}(l/r.pixelRatio,c/r.pixelRatio,i.columnsWidths[e.cell.column]/r.pixelRatio,i.rowsHeights[e.cell.row]/r.pixelRatio,e);t.save();const h=new Path2D;h.rect(l,c,i.columnsWidths[e.cell.column],i.rowsHeights[e.cell.row]),t.clip(h,"evenodd"),n.setData(d),n.draw(t,r),t.restore()})}f.set(p.PlotSymbolSize.Auto,14),f.set(p.PlotSymbolSize.Tiny,8),f.set(p.PlotSymbolSize.Small,10),f.set(p.PlotSymbolSize.Normal,14),f.set(p.PlotSymbolSize.Large,20),f.set(p.PlotSymbolSize.Huge,36);class g{constructor(t){this._data=null,this._widthsCaches=new Map,this._precalculated=null,this._hittestRendererData=null,this.setData(t),this._measureCanvas=document.createElement("canvas"),this._measureCtx=Object(o.ensureNotNull)(this._measureCanvas.getContext("2d")),this._hittestRenderer=new c.RectangleRenderer(new l.HitTestResult(l.HitTestResult.REGULAR),new l.HitTestResult(l.HitTestResult.REGULAR))}setData(t){this._data=t,this._precalculated=null}draw(t,e){var i;if(null===this._data)return;const r=null!==(i=this._precalculated)&&void 0!==i?i:this._precalculate(e),n=Object(o.ensureNotNull)(this._data);!function(t,e,i){t.fillStyle=e.style.backgroundColor,t.fillRect(i.position.x,i.position.y,i.totalWidth,i.totalHeight)}(t,n,r),function(t,e,i){e.cells.forEach(e=>{
const r=i.position.x+i.columnsOffsets[e.cell.column],n=i.position.y+i.rowsOffsets[e.cell.row],o=i.columnsWidths[e.cell.column],s=i.rowsHeights[e.cell.row];t.fillStyle=e.style.backgroundColor,t.fillRect(r,n,o,s)})}(t,n,r),_(t,n,r,e),function(t,e,i,r){if(e.table.borderWidth>0){const n=Math.max(1,Math.round(e.table.borderWidth*r.pixelRatio));t.fillStyle=e.style.borderColor;for(let r=0;r<e.table.columns-1;r++){const e=i.columnsWidths[r];if(0===e)continue;const o=i.position.x+i.columnsOffsets[r]+e;t.fillRect(o,i.position.y,n,i.totalHeight)}for(let r=0;r<e.table.rows-1;r++){const e=i.rowsHeights[r];if(0===e)continue;const o=i.position.y+i.rowsOffsets[r]+e;t.fillRect(i.position.x,o,i.totalWidth,n)}}}(t,n,r,e),function(t,e,i,r){if(e.table.frameWidth>0){const n=Math.max(1,Math.round(e.table.frameWidth*r.pixelRatio));t.fillStyle=e.style.frameColor,t.fillRect(i.position.x-n,i.position.y-n,i.totalWidth+2*n,n),t.fillRect(i.position.x-n,i.position.y+i.totalHeight,i.totalWidth+2*n,n),t.fillRect(i.position.x-n,i.position.y-n+n,n,i.totalHeight),t.fillRect(i.position.x+i.totalWidth,i.position.y,n,i.totalHeight)}}(t,n,r,e);const a=r.position.x/e.pixelRatio,l=r.position.y/e.pixelRatio,c=r.totalWidth/e.pixelRatio,d=r.totalHeight/e.pixelRatio;this._hittestRendererData={backcolor:n.style.backgroundColor,color:n.style.borderColor,fillBackground:!0,linewidth:n.table.borderWidth,extendLeft:!1,extendRight:!1,points:[new s.Point(a,l),new s.Point(a+c,l+d)]},this._hittestRenderer.setData(this._hittestRendererData)}hitTest(t,e){return this._hittestRenderer.hitTest(t,e)}_precalculate(t){const e=Object(o.ensureNotNull)(this._data),i=Array.from({length:e.table.columns},()=>0),r=Array.from({length:e.table.rows},()=>0),n=[],a=[];e.cells.forEach(n=>{const o=Math.ceil(this._cellWidth(t,n,e)*t.pixelRatio),s=Math.ceil(this._cellHeight(t,n,e)*t.pixelRatio);i[n.cell.column]=Math.max(i[n.cell.column],o),r[n.cell.row]=Math.max(r[n.cell.row],s)});const l=i.filter(t=>t>0).length,c=r.filter(t=>t>0).length,d=0===e.table.borderWidth?0:Math.max(1,Math.round(e.table.borderWidth*t.pixelRatio)),h=i.reduce((t,e)=>t+e,0)+d*(l-1),u=r.reduce((t,e)=>t+e,0)+d*(c-1);let p=0;for(let o=0;o<e.table.columns;o++){const t=i[o];n.push(p),p+=t?t+d:0}let f=0;for(let o=0;o<e.table.rows;o++){const t=r[o];a.push(f),f+=t?t+d:0}const _=function(t,e,i,r){const n=Math.round(10*e.pixelRatio);let o=0;t.table.position.startsWith("top_")?o=n:t.table.position.startsWith("middle_")?o=Math.round((e.physicalHeight-r)/2):t.table.position.startsWith("bottom_")&&(o=e.physicalHeight-n-r);let a=0;return t.table.position.endsWith("left")?a=n:t.table.position.endsWith("center")?a=Math.round((e.physicalWidth-i)/2):t.table.position.endsWith("right")&&(a=e.physicalWidth-i-n),new s.Point(a,o)}(e,t,h,u);return this._precalculated={columnsWidths:i,rowsHeights:r,rowsOffsets:a,columnsOffsets:n,position:_,totalWidth:h,totalHeight:u},this._precalculated}_cellWidth(t,e,i){var r;if(""===e.cell.text&&0===e.cell.widthInPercentsOfPaneWidth)return 0;if(e.cell.widthInPercentsOfPaneWidth){
return(t.cssWidth-20)*e.cell.widthInPercentsOfPaneWidth/100}const n=e.cell.text.split("\n"),s=Object(o.ensureDefined)(f.get(e.cell.fontSize)),l=null!==(r=this._widthsCaches.get(s))&&void 0!==r?r:new h.TextWidthCache;this._widthsCaches.set(s,l),this._measureCtx.font=Object(u.makeFont)(s,a.CHART_FONT_FAMILY);const c=n.map(t=>l.measureText(this._measureCtx,t));return Math.max(...c)+2*i.table.borderWidth+2*s/3}_cellHeight(t,e,i){if(""===e.cell.text&&0===e.cell.heightInPercentOfPaneHeight)return 0;if(e.cell.heightInPercentOfPaneHeight){return(t.cssHeight-20)*e.cell.heightInPercentOfPaneHeight/100}const r=e.cell.text.split("\n").length,n=Object(o.ensureDefined)(f.get(e.cell.fontSize));return n*r+n*(2/3)+2*i.table.borderWidth}}i.d(e,"DwgTablePaneView",(function(){return x}));class x{constructor(t,e,i){this._invalidated=!0,this._data=[],this._renderers=[],this._source=t}renderer(){this._invalidated&&(this._invalidated=!1,this._updateViewInternal());const t=new r.CompositeRenderer;return this._data.forEach((e,i)=>{this._renderers.length<=i?this._renderers.push(new g(e)):this._renderers[i].setData(e),t.append(this._renderers[i])}),this._renderers.splice(this._data.length),t}update(){this._invalidated=!0}_updateViewInternal(){this._data=[];const t=this._source.properties().palettes,e=this._source.metaInfo().isRGB;if((void 0===t||void 0===t.palette_common)&&!e)return;const i=t.palette_common,r=this._source.graphics().dwgtables(),o=this._source.graphics().dwgtablecells(),s=new Map;o.forEach((t,r)=>{t.forEach(t=>{const r=s.get(t.tableId)||[];let o,a;if(e)o=Object(n.rgbaFromInteger)(t.backgroundColorIndex),a=Object(n.rgbaFromInteger)(t.textColorIndex);else{const e=i.colors[t.backgroundColorIndex],r=i.colors[t.textColorIndex];if(!r)return;o=e?e.color.value():"transparent",a=r.color.value()}r.push({cell:t,style:{backgroundColor:o,textColor:a}}),s.set(t.tableId,r)})}),r.forEach((t,r)=>{this._source.properties().graphics.dwgtables[r].visible.value()&&t.forEach(t=>{let r,o,a;if(e)r=Object(n.rgbaFromInteger)(t.backgroundColorIndex),o=Object(n.rgbaFromInteger)(t.borderColorIndex),a=Object(n.rgbaFromInteger)(t.frameColorIndex);else{const e=i.colors[t.backgroundColorIndex],n=i.colors[t.borderColorIndex],s=i.colors[t.frameColorIndex];r=e?e.color.value():"transparent",o=n?n.color.value():"transparent",a=s?s.color.value():"transparent"}this._data.push({table:t,style:{backgroundColor:r,borderColor:o,frameColor:a},cells:s.get(t.id)||[]})})})}}},psYU:function(t,e,i){"use strict";i.r(e),i.d(e,"VertLinePaneView",(function(){return l}));var r=i("Eyy1"),n=i("VdBB"),o=i("972a"),s=i("Zy3/"),a=i("z+cS");class l{constructor(t,e,i){this._data=[],this._invalidated=!0,this._provider=t,this._model=e,this._hitTestResult=void 0!==i?new n.HitTestResult(n.HitTestResult.CUSTOM,i):new n.HitTestResult(n.HitTestResult.REGULAR)}update(){this._invalidated=!0}renderer(){this._invalidated&&(this._updateViewInternal(),this._invalidated=!1);const t=new s.CompositeRenderer;for(const e of this._data){const i=new a.VerticalLineRenderer;i.setData(e),
i.setHitTest(this._hitTestResult),t.append(i)}return t}_updateViewInternal(){this._data=[];const t=this._provider.priceScale(),e=this._model.timeScale();if(!t||t.isEmpty()||e.isEmpty())return;const i=this._provider.graphicsInfo().vertlines,n=this._provider.graphics().vertlines();if(0===n.size||void 0===i)return;const s=this._model.timeScale().visibleBarsStrictRange();if(null===s)return;const a=this._provider.firstValue();if(null===a)return;const l=s.firstBar(),c=s.lastBar();n.forEach((n,s)=>{const d=this._provider.properties().graphics.vertlines[s];if(!d.visible.value())return;let h=0;switch(Object(r.ensureDefined)(i[s]).halign){case o.HAlign.Left:h=-e.barSpacing()/2;break;case o.HAlign.Right:h=e.barSpacing()/2}n.forEach(i=>{const n=i.index;n<l||c<n||this._data.push({x:e.indexToCoordinate(n)+h,top:i.extendTop?void 0:t.priceToCoordinate(Object(r.ensureDefined)(i.endPrice),a),bottom:i.extendBottom?void 0:t.priceToCoordinate(Object(r.ensureDefined)(i.startPrice),a),color:d.color.value(),linewidth:d.width.value(),linestyle:d.style.value()})})})}}},qVqd:function(t,e,i){"use strict";i.r(e);var r=i("Eyy1"),n=i("aO4+"),o=i("972a"),s=i("Zy3/"),a=i("f6yo"),l=i("VdBB"),c=i("ikwP");class d{constructor(t){this._data=t}draw(t,e){const i="down"===this._data.direction?1:"up"===this._data.direction?-1:0,r=this._data.point.x,n=this._data.point.y;Object(c.drawScaled)(t,e.pixelRatio,()=>{t.fillStyle=this._data.color,t.beginPath(),t.arc(r+1,n+2*this._data.size*i,this._data.size,0,2*Math.PI),t.closePath(),t.fill(),t.stroke()})}hitTest(t){const e="down"===this._data.direction?1:"up"===this._data.direction?-1:0,i=new n.Point(this._data.point.x+.5,this._data.point.y+.5+2*this._data.size*e);return Object(a.pointInCircle)(t,i,this._data.size)?new l.HitTestResult(l.HitTestResult.REGULAR):null}}class h{constructor(t){this._data=t}draw(t,e){const i="down"===this._data.direction?1:"up"===this._data.direction?-1:0,r=this._data.size,o=new n.Point(this._data.point.x-r/2,this._data.point.y-r/2+i*r),s=new n.Point(this._data.point.x+r/2,this._data.point.y+r/2+i*r).subtract(o),a=e.pixelRatio,l=Math.max(1,Math.floor(a)),c=l/2,d=l%2?.5:0,h=Math.round(o.x*a)+d,u=Math.round((o.x+s.x)*a)+d,p=Math.round(o.y*a)+d,f=Math.round((o.y+s.y)*a)+d;t.beginPath(),t.fillStyle=this._data.color,t.rect(h+c,p+c,u-h-l,f-p-l),t.fill(),t.lineWidth=l,t.beginPath(),t.rect(h,p,u-h,f-p),t.stroke()}hitTest(t){const e="down"===this._data.direction?1:"up"===this._data.direction?-1:0,i=this._data.size,r=new n.Point(this._data.point.x-i/2,this._data.point.y-i/2+e*i),o=new n.Point(this._data.point.x+i/2,this._data.point.y+i/2+e*i);return Object(a.pointInBox)(t,Object(n.box)(r,o))?new l.HitTestResult(l.HitTestResult.REGULAR):null}}class u{constructor(t,e){this._data=t,this._arrowDirection=e}draw(t,e){const i=this._arrowDirection,r=this._data.size,n=this._data.color,o=this._data.point.x+1;let s=this._data.point.y;const a=1.1*r;switch(i){case"up":s-=a;break;case"down":s+=a}const l=r/6,d=r/4,h=r/3,u=r/2,p=.6666666*r;Object(c.drawScaled)(t,e.pixelRatio,()=>{switch(t.fillStyle=n,t.beginPath(),
i){case"up":t.moveTo(o,s),t.lineTo(o-u,s+p),t.lineTo(o-d,s+p),t.lineTo(o,s+h),t.lineTo(o+d,s+p),t.lineTo(o+u,s+p),t.lineTo(o,s);break;case"down":t.moveTo(o,s+r),t.lineTo(o-u,s+h),t.lineTo(o-d,s+h),t.lineTo(o,s+p),t.lineTo(o+d,s+h),t.lineTo(o+u,s+h),t.lineTo(o,s+r);break;case"right":t.moveTo(o+l,s),t.lineTo(o-l,s-d),t.lineTo(o-l,s+d),t.lineTo(o+l,s);break;case"left":t.moveTo(o-l,s),t.lineTo(o+l,s-d),t.lineTo(o+l,s+d),t.lineTo(o-l,s)}t.closePath(),t.fill(),t.stroke()})}hitTest(t){const[e,i,r]=this._hitTriangle();return Object(a.pointInTriangle)(t,e,i,r)?new l.HitTestResult(l.HitTestResult.REGULAR):null}_hitTriangle(){const t=this._data.point.x;let e=this._data.point.y;const i=this._arrowDirection,r=this._data.size,o=1.1*r;switch(i){case"up":e-=o;break;case"down":e+=o}const s=r/6,a=r/4,l=r/3,c=r/2,d=.6666666*r;switch(i){case"up":return[new n.Point(t,e),new n.Point(t+c,e+d),new n.Point(t-c,e+d)];case"down":return[new n.Point(t,e+r),new n.Point(t+c,e+l),new n.Point(t-c,e+l)];case"right":return[new n.Point(t+s,e),new n.Point(t-s,e-a),new n.Point(t-s,e+a)];case"left":return[new n.Point(t-s,e),new n.Point(t+s,e-a),new n.Point(t+s,e+a)]}}}var p=i("tSCe"),f=i.n(p),_=i("Tmoa"),g=i("txPx");i.d(e,"ShapeMarkPaneView",(function(){return v}));const x=Object(g.getLogger)("Chart.ShapeMarkPaneView");class v extends f.a{constructor(t,e,i){super(),this._data=[],this._invalidated=!0,this._provider=t,this._model=e,this._data=[]}update(){this._invalidated=!0}renderer(){this._invalidated&&(this._updateViewInternal(),this._invalidated=!1);const t=new s.CompositeRenderer;for(const e of this._data)switch(e.shape){case"circle":t.append(new d(e));break;case"square":t.append(new h(e));break;case"arrowUp":t.append(new u(e,"up"));break;case"arrowDown":t.append(new u(e,"down"));break;case"arrowRight":t.append(new u(e,"right"));break;case"arrowLeft":t.append(new u(e,"left"))}return t}_updateViewInternal(){this._data=[];const t=this._provider.priceScale(),e=this._model.timeScale();if(!t||t.isEmpty()||e.isEmpty())return;const i=this._provider.graphics().shapemarks();if(0===i.size)return;const r=this._model.timeScale().visibleBarsStrictRange();if(null===r)return;const o=this._provider.firstValue();if(null===o)return;const s=r.firstBar(),a=r.lastBar();i.forEach((i,r)=>{const l=this._provider.properties().graphics.shapemarks[r];l.visible.value()&&i.forEach(i=>{const r=i.time;if(r<s||a<r)return;if(null===this._provider.series().bars().valueAt(r))return;const c="left"===l.halign.value()?-(e.barSpacing()/2+1):"right"===l.halign.value()?e.barSpacing()/2+1:0,d=l.location.value(),h=l.shape.value(),u=parseInt(l.size.value()),p=Object(_.generateColor)(l.color.value(),l.transparency.value()),{x:f,y:g,direction:x}=this._calcCoordsForShape(d,r,u,i.price,o,t,e);switch(h){case"circle":case"square":this._data.push({shape:h,color:p,direction:x,point:new n.Point(f+c,g),size:u});break;case"arrowUp":case"arrowDown":case"arrowRight":case"arrowLeft":this._data.push({shape:h,color:p,point:new n.Point(f+c,g),size:u})}})})}_calcCoordsForShape(t,e,i,n,s,a,l){
const c=Math.round(l.indexToCoordinate(e));switch(t){case o.MarkLocation.Absolute:return{x:c,y:a.priceToCoordinate(Object(r.ensureDefined)(n),s),direction:""};case o.MarkLocation.AbsoluteDown:return{x:c,y:a.priceToCoordinate(Object(r.ensureDefined)(n),s),direction:"down"};case o.MarkLocation.AbsoluteUp:return{x:c,y:a.priceToCoordinate(Object(r.ensureDefined)(n),s),direction:"up"};case o.MarkLocation.AboveBar:return{x:c,y:this._locationToY(t,e,Math.floor(2*i/l.barSpacing())+1),direction:"up"};case o.MarkLocation.BelowBar:return{x:c,y:this._locationToY(t,e,Math.floor(2*i/l.barSpacing())+1),direction:"down"};default:return x.logWarn("Bad location value: "+t),{x:c,y:this._locationToY(o.MarkLocation.AbsoluteUp,e),direction:"up"}}}}},rvCT:function(t,e,i){"use strict";i.r(e),i.d(e,"LinearRegressionPaneView",(function(){return p}));var r=i("Eyy1"),n=i("aO4+"),o=i("VdBB"),s=i("Tmoa"),a=i("Zy3/"),l=i("NN6M"),c=i("pJOz"),d=i("qgcf"),h=i("a7Ha"),u=i("zDbI");class p{constructor(t,e){this._invalidated=!0,this._lines=[],this._pearsonsTextRenderer=new d.TextRenderer,this._pearsons=null,this._model=t,this._source=e}update(){this._invalidated=!0}renderer(){this._invalidated&&(this._updateImpl(),this._invalidated=!1);const t=new a.CompositeRenderer,e=[this._lines[1],this._lines[0],this._lines[2]],i=[];for(const r of e)r&&i.push(r);for(let r=1;r<i.length;r++){const i={points:[e[r].floatPoints[0],e[r].floatPoints[1],e[r-1].floatPoints[0],e[r-1].floatPoints[1]],color:e[r].color,linewidth:e[r].linewidth,linestyle:e[r].linestyle,extendleft:!1,extendright:e[r].extendright,backcolor:e[r].color,transparency:this._source.properties().styles.transparency.value(),skipLines:!0,fillBackground:!0,showMidline:!1},n=new l.ParallelChannelRenderer(new o.HitTestResult(o.HitTestResult.REGULAR),new o.HitTestResult(o.HitTestResult.REGULAR));n.setData(i),t.append(n)}for(const r of function(t){return t.map(t=>{const e=Object.assign({},t);return e.color=Object(s.resetTransparency)(e.color),e})}(this._lines)){const e=new c.TrendLineRenderer;e.setData(r),e.setHitTest(new o.HitTestResult(o.HitTestResult.REGULAR)),t.append(e)}return this._pearsons&&(this._pearsons.color=Object(s.resetTransparency)(this._pearsons.color),this._pearsonsTextRenderer.setData(this._pearsons),t.append(this._pearsonsTextRenderer)),t}_updateImpl(){if(this._lines=[],this._pearsons=null,!this._source.properties().visible.value())return;const t=this._model.timeScale(),e=this._source.priceScale(),i=this._model.mainSeries().firstBar();if(!e||e.isEmpty()||t.isEmpty()||!i)return;const o=this._source.startIndex(),s=this._source.endIndex();if(null===o||null===s)return;const a=[this._source.baseLine(),this._source.downLine(),this._source.upLine()],l=Math.round(t.indexToCoordinate(o)),c=Math.round(t.indexToCoordinate(s)),d=this._source.properties(),p=[d.styles.baseLine,d.styles.downLine,d.styles.upLine],f=i[TradingView.CLOSE_PLOT];for(let u=0;u<a.length;u++){if(!p[u].visible.value())continue;const t=Object(r.ensureNotNull)(a[u]).startPrice,i=Object(r.ensureNotNull)(a[u]).endPrice
;if(void 0===t||void 0===i)continue;const o=e.priceToCoordinate(t,f),s=e.priceToCoordinate(i,f),_=new n.Point(l,o),g=new n.Point(c,s),x=p[u].color.value(),v=p[u].linewidth.value(),w=p[u].linestyle.value(),b={floatPoints:[_,g],width:this._model.timeScale().width(),height:Object(r.ensureNotNull)(this._source.priceScale()).height(),color:x,linewidth:v,linestyle:w,extendleft:!1,extendright:d.styles.extendLines.value(),leftend:h.LineEnd.Normal,rightend:h.LineEnd.Normal};this._lines.push(b)}const _=Object(r.ensureNotNull)(this._source.downLine());if(d.styles.showPearsons.value()&&void 0!==_.startPrice){const t=e.priceToCoordinate(_.startPrice,f),i=new n.Point(l,t);this._pearsons={points:[i],text:""+this._source.pearsons(),color:d.styles.downLine.color.value(),vertAlign:"top",horzAlign:"center",font:u.CHART_FONT_FAMILY,offsetX:0,offsetY:4,fontsize:12}}}}},tSCe:function(t,e,i){"use strict";var r=i("Hr11"),n=r.min,o=r.max,s=i("972a").MarkLocation;function a(){}a.prototype._locationToY=function(t,e,i){i||(i=0);var r,a=[],l=this._provider.priceScale();switch(t){case s.AboveBar:r=TradingView.HIGH_PLOT;break;case s.BelowBar:r=TradingView.LOW_PLOT}var c=this._provider.firstValue();i>=1&&(i-=1);for(var d=-i;d<=i;d++){var h=this._provider.series().bars().valueAt(e+d);if(null!==h){var u=h[r];a.push(l.priceToCoordinate(u,c))}}switch(t){case s.AboveBar:return n(a)-15;case s.BelowBar:return o(a)+15}},t.exports=a}}]);